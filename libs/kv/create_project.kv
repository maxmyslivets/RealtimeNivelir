#:import images_path kivymd.images_path
#:import toast kivymd.toast.toast

<Create_project>:

    MDToolbar:
        id: toolbar
        title: 'Realtime Nivelir'
        md_bg_color: app.theme_cls.primary_color
        elevation: 10
        pos_hint: {'top': 1}
        left_action_items: [["menu", lambda x: nav_drawer.set_state("toggle")]]
        right_action_items: [["minus", lambda x: root.add_stantion_label_1()], ["plus", lambda x: root.add_stantion_label_2()]]

    BoxLayout:
        orientation: "vertical"
        size_hint_y: None
        height: root.height - toolbar.height

        MDSeparator:

        ScrollView:

            BoxLayout:
                size_hint_y: None
                height: self.minimum_height
                orientation: 'vertical'

                BoxLayout:
                    id: list1
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height

                    BoxLayout:
                        orientation: 'vertical'
                        padding: '10dp'
                        size_hint_y: None
                        height: self.minimum_height
                    
                        MDLabel:
                            size_hint_y: None
                            text: 'Прямой ход'

                        MDTextField:
                            id: H0
                            size_hint_x: .8
                            pos_hint: {'center_x': .5}
                            hint_text: "Высота точки стояния задней рейки"
                            input_filter: "float"
                            text: '124.4523'

                    Stantion_1:
                
                BoxLayout:
                    id: list2
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height

                    BoxLayout:
                        orientation: 'vertical'
                        padding: '10dp'
                        size_hint_y: None
                        height: self.minimum_height
                    
                        MDLabel:
                            size_hint_y: None
                            text: 'обратный ход'

                    Stantion_2:
                
        MDBottomAppBar:
            MDToolbar:
                id: bottom_toolbar1
                title: ""
                icon: "plus"
                type: "bottom"
                mode: "end"
                on_action_button: pass
                left_action_items: [["menu", lambda x: toast('Экспорт, Ведомость, Удалить проект')]]
            
    MDNavigationDrawer:
        id: nav_drawer

        BoxLayout:
            orientation: 'vertical'

            BoxLayout:
                id: top_box
                size_hint_y: None
                height: "200dp"
                pos_hint: {"top": 1}

                FitImage:
                    source: f"{images_path}kivymd_alpha.png"
                
                GridLayout:
                    cols: 1
                    MDLabel:
                        font_style: 'H4'
                        text: 'Realtime\nNivelir'

                    MDLabel:
                        theme_text_color: 'Secondary'
                        text: 'version: 0.1.0'
            
            ScrollView:
                pos_hint: {"top": 1}

                GridLayout:
                    cols: 1
                    size_hint_y: None
                    height: self.minimum_height
                    padding: "20dp", 0, 0, 0
                    spacing: "10dp"

                    MDRectangleFlatIconButton:
                        text: 'Home'
                        icon: 'home-circle-outline'
                        size_hint: 1, None
                        height: "50dp"
                        on_release: root.manager.current = "home"
                    
                    MDRectangleFlatIconButton:
                        text: 'Create project...'
                        icon: 'star'
                        size_hint: 1, None
                        height: "50dp"
                        on_release: root.manager.current = "create_project"
                    
                    MDRectangleFlatIconButton:
                        text: 'Open project...'
                        icon: 'folder'
                        size_hint: 1, None
                        height: "50dp"
                        on_release: root.manager.current = "open_project"
                    
                    MDRectangleFlatIconButton:
                        text: 'Documentation'
                        icon: 'book'
                        size_hint: 1, None
                        height: "50dp"
                        on_release: root.manager.current = "documentation"
                    
                    MDRectangleFlatIconButton:
                        text: 'Exit'
                        icon: 'exit-to-app'
                        size_hint: 1, None
                        height: "50dp"
                        on_release: app.stop()


<Stantion_1>:
    id: stantion_label_1
    orientation: 'vertical'
    padding: '10dp'
    size_hint_y: None
    height: self.minimum_height

    MDSeparator:

    MDTextField:
        id: name_stantion
        size_hint_x: .9
        pos_hint: {'center_x': .5}
        hint_text: 'Имя станции'
        text: '1'
    
    GridLayout:
        size_hint_y: None
        height: self.minimum_height
        spacing: '10dp'
        cols: 2

        MDTextField:
            id: sp
            text: '37.5'
            hint_text: 'Sп'
            input_filter: "float"
            helper_text: "Длина переднего плеча"
            helper_text_mode: "on_focus"

        MDTextField:
            id: sz
            text: '37.5'
            hint_text: 'Sз'
            input_filter: "float"
            helper_text: "Длина заднего плеча"
            helper_text_mode: "on_focus"

    BoxLayout:
        size_hint_y: None
        height: self.minimum_height

        GridLayout:
            size_hint_y: None
            height: self.minimum_height
            spacing: '10dp'
            cols: 2
            rows: 4

            MDTextField:
                id: zo1
                text: '15.3967'
                hint_text: 'ЗО (1)'
                input_filter: "float"
                helper_text: "Задний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: zo2
                text: '15.3969'
                hint_text: 'ЗО (2)'
                input_filter: "float"
                helper_text: "Задний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: po1
                text: '26.1276'
                hint_text: 'ПО (1)'
                input_filter: "float"
                helper_text: "Передний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: po2
                text: '26.1301'
                hint_text: 'ПО (2)'
                input_filter: "float"
                helper_text: "Передний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: pd1
                text: '85.3728'
                hint_text: 'ПД (1)'
                input_filter: "float"
                helper_text: "Передний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: pd2
                text: '85.3839'
                hint_text: 'ПД (2)'
                input_filter: "float"
                helper_text: "Передний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: zd1
                text: '74.6429'
                hint_text: 'ЗД (1)'
                input_filter: "float"
                helper_text: "Задний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: zd2
                text: '74.6429'
                hint_text: 'ЗД (2)'
                input_filter: "float"
                helper_text: "Задний отсчет"
                helper_text_mode: "on_focus"
    
        MDFillRoundFlatButton:
            id: dop_btn
            size_hint: .3, 1
            text: '%\nот\nдоп.'
            on_release:
                if root.dop_result_1(str(name_stantion.text), float(sp.text), float(sz.text), float(zo1.text), float(zo2.text), float(po1.text), float(po2.text), float(pd1.text), float(pd2.text), float(zd1.text), float(zd2.text)) == False: self.md_bg_color = [.9, .16, .16, 1]
                else: self.md_bg_color = app.theme_cls.primary_color 

    MDLabel:
        id: h_res
        size_hint_y: None
        height: '48dp'
        text: 'h = '

    MDLabel:
        id: H_res
        size_hint_y: None
        height: '48dp'
        text: 'Н (прибл) = '


<Stantion_2>:
    id: stantion_label_2
    orientation: 'vertical'
    padding: '10dp'
    size_hint_y: None
    height: self.minimum_height

    MDSeparator:

    MDTextField:
        id: name_stantion
        size_hint_x: .9
        pos_hint: {'center_x': .5}
        hint_text: 'Имя станции'
        text: '1'
    
    GridLayout:
        size_hint_y: None
        height: self.minimum_height
        spacing: '10dp'
        cols: 2

        MDTextField:
            id: sp
            text: '370.5'
            hint_text: 'Sп'
            input_filter: "float"
            helper_text: "Длина переднего плеча"
            helper_text_mode: "on_focus"

        MDTextField:
            id: sz
            text: '370.5'
            hint_text: 'Sз'
            input_filter: "float"
            helper_text: "Длина заднего плеча"
            helper_text_mode: "on_focus"

    BoxLayout:
        size_hint_y: None
        height: self.minimum_height

        GridLayout:
            size_hint_y: None
            height: self.minimum_height
            spacing: '10dp'
            cols: 2
            rows: 4

            MDTextField:
                id: zo1
                text: '150.3967'
                hint_text: 'ЗО (1)'
                input_filter: "float"
                helper_text: "Задний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: zo2
                text: '150.3969'
                hint_text: 'ЗО (2)'
                input_filter: "float"
                helper_text: "Задний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: po1
                text: '260.1276'
                hint_text: 'ПО (1)'
                input_filter: "float"
                helper_text: "Передний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: po2
                text: '260.1301'
                hint_text: 'ПО (2)'
                input_filter: "float"
                helper_text: "Передний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: pd1
                text: '850.3728'
                hint_text: 'ПД (1)'
                input_filter: "float"
                helper_text: "Передний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: pd2
                text: '850.3839'
                hint_text: 'ПД (2)'
                input_filter: "float"
                helper_text: "Передний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: zd1
                text: '740.6429'
                hint_text: 'ЗД (1)'
                input_filter: "float"
                helper_text: "Задний отсчет"
                helper_text_mode: "on_focus"
            MDTextField:
                id: zd2
                text: '740.6429'
                hint_text: 'ЗД (2)'
                input_filter: "float"
                helper_text: "Задний отсчет"
                helper_text_mode: "on_focus"
    
        MDFillRoundFlatButton:
            id: dop_btn
            size_hint: .3, 1
            text: '%\nот\nдоп.'
            on_release:
                if root.dop_result_2(str(name_stantion.text), float(sp.text), float(sz.text), float(zo1.text), float(zo2.text), float(po1.text), float(po2.text), float(pd1.text), float(pd2.text), float(zd1.text), float(zd2.text)) == False: self.md_bg_color = [.9, .16, .16, 1]
                else: self.md_bg_color = app.theme_cls.primary_color 

    MDLabel:
        id: h_res
        size_hint_y: None
        height: '48dp'
        text: 'h = '

    MDLabel:
        id: H_res
        size_hint_y: None
        height: '48dp'
        text: 'Н (прибл) = '


    
    